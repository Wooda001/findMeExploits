#!/bin/python3
import requests
import json
import sys

cveList = []
if len(sys.argv) < 2:
	CVE = input("CVE#: ") 
	cveList.append(CVE)
elif len(sys.argv) > 2:
	for CVE in sys.argv[1:]:
		if "CVE" not in CVE:
			CVE = "CVE-" + CVE
		cveList.append(CVE)
else: 
	CVE = sys.argv[1]
	if "CVE" not in CVE:
		CVE = "CVE-" + CVE
	cveList.append(CVE)

	
def checkNVD(CVE):
	exploitLinks = []
	#Non-Keyed request rate limit is 10/Min; With API key, it goes up to 100/Min 
	nvdUrl = "https://services.nvd.nist.gov/rest/json/cve/1.0/" 
	nvdLookup = nvdUrl + CVE
	try:
		nvdPage = requests.get(nvdLookup) 
		jsonNVD = json.loads(nvdPage.text) 
		references = jsonNVD["result"]["CVE_Items"][0]["cve"]["references"]["reference_data"] 

		for ref in references:
			if "Exploit" in ref["tags"]:
				exploitLinks.append(ref["url"])
		print("\n------------------------------------")
		print(f"{CVE}  NVD EXPLOIT LINKS")
		print("------------------------------------\n")
		if len(exploitLinks) > 0:
			for link in exploitLinks: 
				print(link + "\n") 
			print("------------------------------------\n")
		else: 
			print(f"{CVE} NVD: NO EXPLOIT LINKS FOUND\n") 
	except: 
		print(f"{CVE} NVD: NO EXPLOIT LINKS FOUND\n") 
		
def checkGithub(CVE):
	#Doing this as google returns higher relevance than github's search function
	googleDorkBase = f"https://google.com/search?as_sitesearch=github.com&q={CVE}+exploit+PoC\n"
	print (f"{CVE} POSSIBLE GITHUB RESULTS: {googleDorkBase}") 
	print("------------------------------------\n")
print(cveList)
for CVE in cveList:
	checkNVD(CVE)
	checkGithub(CVE)
